!function(e,n){for(var t in n)e[t]=n[t]}(exports,function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=new(t(9).DynamoDB.DocumentClient)({region:"us-east-2",convertEmptyValues:!0});n.scan=function(e){return new Promise((n,t)=>r.scan(e).promise().then(e=>n(e.Items)).catch(e=>t(e)))},n.get=function(e){return new Promise((n,t)=>r.get(e).promise().then(e=>n(e.Item)).catch(e=>t(e)))},n.createItem=function(e){return new Promise((n,t)=>r.put(e).promise().then(()=>n(e.Item)).catch(e=>t(e)))},n.updateItem=function(e,n){return new Promise((t,o)=>r.update(e).promise().then(()=>t(n)).catch(e=>o(e)))},n.deleteItem=function(e,n){return new Promise((t,o)=>r.delete(e).promise().then(()=>t(n)).catch(e=>o(e)))}},function(e,n,t){t(2);var r=t(3),o=function(e){return e&&e.__esModule?e:{default:e}}(t(4)),i=t(5),a=t(6),s=t(7),l=t(15);const u="https://neuzkzc4df.execute-api.us-east-2.amazonaws.com",c=(0,i.makeExecutableSchema)({typeDefs:a.schema,resolvers:s.resolvers,logger:console});n.graphqlHandler=function(e,n,t){return(0,r.graphqlLambda)({schema:c,tracing:!0})(e,n,function(e,n){n.headers["Access-Control-Allow-Origin"]="*",t(e,n)})},n.playgroundHandler=(0,o.default)({endpoint:process.env.REACT_APP_GRAPHQL_ENDPOINT?process.env.REACT_APP_GRAPHQL_ENDPOINT:u+"/dev/graphql"}),n.graphiqlHandler=(0,r.graphiqlLambda)({endpointURL:process.env.REACT_APP_GRAPHQL_ENDPOINT?process.env.REACT_APP_GRAPHQL_ENDPOINT:u+"/dev/graphql"}),n.userConfirmation=((e,n,t)=>{const r=e.pathParameters.token,o={statusCode:200,body:"sucess"};(0,l.confirmUser)(r).then(e=>{o.body=e,t(null,o)},e=>{t(e,null)})})},function(e,n){e.exports=require("graphql")},function(e,n){e.exports=require("apollo-server-lambda")},function(e,n){e.exports=require("graphql-playground-middleware-lambda")},function(e,n){e.exports=require("graphql-tools")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.schema="\ntype Mutation {\n    # add credential for user\n    AddCredential(id : String!, mail: String!) : User!\n    registerUser(mail: String!) : Boolean!\n}\n\ntype Query {\n    #get perfil by id user \n    getPerfil(id: String!): Perfil\n\n    # listCredential by user\n    getAllCredential(id: String!): [Credential]\n}\n\n\ntype Perfil{\n    perfil_id:String!\n    name: String!\n    last_name: String!\n    phone: Int!\n    photo: String!\n\n}\n\ntype User{\n    id: String!\n    status: Boolean!\n    credentials: [Credential]\n    perfil: Perfil  \n} \n\ntype Credential {\n    mail : String!\n}\n\nschema {\n    query: Query\n    mutation: Mutation\n}"},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t(8),o=t(0),i=t(10),a=t(11);function s(e){var n={TableName:"User",Key:{id:e}};return o.get(n).then(e=>(function(e){const n={TableName:"Perfil",Key:{perfil_id:e}};return o.get(n).then(e=>e,e=>console.log(e))})(e.perfil_id),e=>console.log(e))}function l(e){if(!function(e){return void 0===i({from:e},{from:{email:!0}})}(e))return new Promise((e,n)=>{e(!1)});const n=r.v4(),t={TableName:"Credential",Item:{mail:e,userId:n}};o.createItem(t).then(e=>console.log(e),e=>console.log(e));const s={TableName:"User",Item:{id:n,status:!1}};return a.send(e,n),o.createItem(s).then(e=>(console.log(e),!0),e=>(console.log(e),!1))}n.resolvers={Query:{getPerfil:(e,n)=>s(n.id),getAllCredential:(e,n)=>(function(e){var n={TableName:"User",Key:{id:e}};return o.get(n).then(e=>{var n=[];for(const t of e.credentials)n.push({mail:t});return n},e=>console.log(e))})(n.id)},Mutation:{registerUser:(e,n)=>l(n.mail)}}},function(e,n){e.exports=require("uuid")},function(e,n){e.exports=require("aws-sdk")},function(e,n){e.exports=require("validate.js")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(12);t(13);const o=t(14),i={host:"smtp.gmail.com",port:465,secure:!0,auth:{user:o.mailUser,pass:o.mailPassword}};var a=r.createTransport(i);n.send=function(e,n){var t={from:" Stack Bio  <awsfreetrial2018@gmail.com>",to:e,subject:"Please confirm your Email account",html:"Hello sr:"+e+",<br> Please Click on the link to verify your email.<br><a href=https://neuzkzc4df.execute-api.us-east-2.amazonaws.com/dev/confirmation/"+n+">Click here to verify</a>"};a.sendMail(t,function(e,n){e?console.log(e):console.log("Message sent: "+n.message)})}},function(e,n){e.exports=require("nodemailer")},function(e,n){e.exports=require("xoauth2")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.mailUser="awsfreetrial2018@gmail.com",n.mailPassword="AWS@2018 "},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t(0);n.confirmUser=function(e){const n={TableName:"User",Key:{id:e}},t={TableName:"User",Key:{id:e},UpdateExpression:"set #s = :s",ExpressionAttributeValues:{":s":!0},ExpressionAttributeNames:{"#s":"status"},ReturnValues:"UPDATED_NEW"};return r.get(n).then(e=>void 0!==e?r.updateItem(t).then(e=>"actualizado",e=>"encantrado pero no actualizado"):"no encontrado",e=>(console.log(e),"fail"))}}]));